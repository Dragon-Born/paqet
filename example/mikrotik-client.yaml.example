# MikroTik Container Client Configuration
#
# This config is designed for running paqet in a MikroTik container.
# The container uses AF_PACKET backend (no libpcap required).
#
# RECOMMENDED: For MikroTik containers, use conn: 1 (single connection).
# Each connection allocates its own AF_PACKET ring buffer, so multiple
# connections increase memory usage. In memory-constrained containers,
# a single connection with KCP/QUIC multiplexing provides excellent throughput.
#
# Available container images (architecture-specific):
#   - ghcr.io/dragon-born/paqet:mikrotik-arm64  (for ARM64 devices like hAP ax3, RB5009)
#   - ghcr.io/dragon-born/paqet:mikrotik-amd64  (for x86 devices like CHR, RB1100AHx4)
#
# MikroTik Setup:
#   1. Enable container mode: /system/device-mode/update container=yes
#   2. Create veth interface: /interface/veth/add name=veth-paqet address=172.17.0.2/24 gateway=172.17.0.1
#   3. Create bridge: /interface/bridge/add name=containers
#   4. Add IP to bridge: /ip/address/add address=172.17.0.1/24 interface=containers
#   5. Add veth to bridge: /interface/bridge/port add bridge=containers interface=veth-paqet
#   6. Add NAT: /ip/firewall/nat/add chain=srcnat action=masquerade src-address=172.17.0.0/24
#   7. Create container mount for config: /container/mounts/add name=paqet-config src=disk1/paqet dst=/config
#   8. Add container (use correct arch for your device):
#      /container/add remote-image=ghcr.io/dragon-born/paqet:mikrotik-arm64 \
#        interface=veth-paqet root-dir=disk1/containers/paqet \
#        mounts=paqet-config start-on-boot=yes logging=yes

role: "client"

log:
  level: "info"

socks5:
  - listen: "0.0.0.0:1080"

network:
  # MikroTik veth interfaces appear as eth0 inside the container
  interface: "eth0"

  pcap:
    backend: "afpacket"   # Required for nopcap build
    sockbuf: 4194304      # 4MB buffer

  tcp:
    local_flag: ["PA"]
    remote_flag: ["PA"]

server:
  addr: "your-server.example.com:8443"

transport:
  protocol: "auto"        # Auto-select best protocol (KCP, QUIC, or UDP)
  conn: 1                 # Recommended for MikroTik containers to save memory (see note above)

  kcp:
    mode: "fast"
    nodelay: 1
    interval: 10
    resend: 2
    nocongestion: 0
    mtu: 1400
    dshard: 10
    pshard: 3
    rcvwnd: 4096
    sndwnd: 4096
    block: "aes"
    key: "your-32-byte-hex-key-here"

  quic:
    key: "your-32-byte-hex-key-here"
    alpn: "h3"
    max_streams: 1024
    idle_timeout: "60s"
